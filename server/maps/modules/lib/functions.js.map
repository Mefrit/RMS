{"version":3,"sources":["../../source/nodeserver/modules/lib/functions.ts"],"names":[],"mappings":"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","file":"../../../modules/lib/functions.js","sourcesContent":["const fs = require(\"fs\"); // Для взаимодействия с файловой системой\r\nconst path = require(\"path\"); // Для работы с путями файлов и каталогов\r\nconst mimeTypes = {\r\n    \".html\": \"text/html\",\r\n    \".js\": \"text/javascript\",\r\n    \".css\": \"text/css\",\r\n    \".ico\": \"image/x-icon\",\r\n    \".png\": \"image/png\",\r\n    \".jpg\": \"image/jpeg\",\r\n    \".gif\": \"image/gif\",\r\n    \".svg\": \"image/svg+xml\",\r\n    \".json\": \"application/json\",\r\n    \".woff\": \"font/woff\",\r\n    \".woff2\": \"font/woff2\",\r\n    \".map\": \"application/json\",\r\n};\r\nimport * as nodemailer from \"nodemailer\";\r\nexport function load_static_file(response, uri) {\r\n    response.setHeader(\"Content-Type\", \"text/html; charset=utf-8;\");\r\n\r\n    // получаем путь после слеша\r\n    // const filePath = request.url.substr(1);\r\n    const filePath = \"..\" + uri.pathname;\r\n\r\n    fs.readFile(filePath, function (error, data) {\r\n        const parsedUrl = new URL(filePath, \"https://node-http.glitch.me/\");\r\n        let pathName = parsedUrl.pathname;\r\n        let ext = path.extname(pathName);\r\n\r\n        if (error) {\r\n            response.statusCode = 404;\r\n            response.end(\"Resourse not found!\");\r\n        } else {\r\n            response.setHeader(\"Content-Type\", mimeTypes[ext]);\r\n            response.end(data);\r\n        }\r\n    });\r\n}\r\nexport function getUrlInfo(url) {\r\n    var result = {};\r\n    url.split(\"&\").forEach(function (part) {\r\n        var item = part.split(\"=\");\r\n        result[item[0]] = decodeURIComponent(item[1]);\r\n    });\r\n    return result;\r\n}\r\nexport function isStatic(url) {\r\n    let result = true;\r\n    const parsedUrl = new URL(url, \"https://node-http.glitch.me/\");\r\n    console.log(\"parsedUrl ==>>> \", parsedUrl);\r\n    result = result && url.indexOf(\"node_modules/bootstrap\") == -1;\r\n    return true;\r\n}\r\nexport function sendEmail(transport_obj, mail_data) {\r\n    return new Promise((resolve, reject) => {\r\n        const transporter = nodemailer.createTransport(transport_obj);\r\n\r\n        transporter.sendMail(mail_data, function (err, info) {\r\n            if (err)\r\n                resolve({ result: false, message: err.message })\r\n            else {\r\n\r\n                resolve({ result: true, info: info })\r\n            }\r\n        });\r\n        // resolve({ result: false, message: \"не удалось отправить сообщение\" })\r\n    })\r\n\r\n}"]}